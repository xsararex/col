<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SEC3 - Dashboard ‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå</title>

<style>
body {
  font-family: Arial, sans-serif;
  background:#f4f6f9;
  padding:20px;
}

h2 {
  margin-bottom:20px;
}

.controls {
  margin-bottom:20px;
}

select, button {
  padding:8px 12px;
  margin-right:10px;
  margin-bottom:10px;
  border-radius:6px;
  border:1px solid #ccc;
}

button {
  background:#2c3e50;
  color:white;
  cursor:pointer;
}

button:hover {
  opacity:0.9;
}

table {
  border-collapse: collapse;
  width:100%;
  background:#fff;
}

th, td {
  border:1px solid #ddd;
  padding:10px;
  text-align:center;
}

th {
  background:#2c3e50;
  color:#fff;
}

.empty {
  text-align:center;
  padding:20px;
  color:#888;
}
</style>
</head>

<body>

<h2>SEC 3 - Dashboard ‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå</h2>

<div class="controls">

  <!-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô -->
  <select id="monthSelect">
    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô --</option>
    <option value="‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°">‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°</option>
    <option value="‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå">‡∏Å‡∏∏‡∏°‡∏†‡∏≤‡∏û‡∏±‡∏ô‡∏ò‡πå</option>
    <option value="‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°">‡∏°‡∏µ‡∏ô‡∏≤‡∏Ñ‡∏°</option>
    <option value="‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô">‡πÄ‡∏°‡∏©‡∏≤‡∏¢‡∏ô</option>
    <option value="‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°">‡∏û‡∏§‡∏©‡∏†‡∏≤‡∏Ñ‡∏°</option>
    <option value="‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô">‡∏°‡∏¥‡∏ñ‡∏∏‡∏ô‡∏≤‡∏¢‡∏ô</option>
    <option value="‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°">‡∏Å‡∏£‡∏Å‡∏é‡∏≤‡∏Ñ‡∏°</option>
    <option value="‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°">‡∏™‡∏¥‡∏á‡∏´‡∏≤‡∏Ñ‡∏°</option>
    <option value="‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô">‡∏Å‡∏±‡∏ô‡∏¢‡∏≤‡∏¢‡∏ô</option>
    <option value="‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°">‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°</option>
    <option value="‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô">‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô</option>
    <option value="‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°">‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°</option>
  </select>

  <button onclick="loadMonth()">‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</button>

  <br>

  <!-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤ -->
  <select id="tenantSelect">
    <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤ --</option>
  </select>

  <button onclick="loadTenant()">‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤</button>

</div>

<table>
  <thead>
    <tr>
      <th>‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤</th>
      <th>‡πÄ‡∏î‡∏∑‡∏≠‡∏ô</th>
      <th>‡πÑ‡∏ü‡πÉ‡∏´‡∏°‡πà</th>
      <th>‡∏ô‡πâ‡∏≥1‡πÉ‡∏´‡∏°‡πà</th>
      <th>‡∏ô‡πâ‡∏≥2‡πÉ‡∏´‡∏°‡πà</th>
    </tr>
  </thead>
  <tbody id="tableBody">
    <tr><td colspan="5" class="empty">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</td></tr>
  </tbody>
</table>

<script>

// üî• ‡πÉ‡∏™‡πà URL Web App ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
const API_URL = "https://script.google.com/macros/s/AKfycbzYo6ezMeNk19b6QytcuK6h7XRwb_yd2bf1pJAfzec__Ab4uARPb7WrvQUNkHkNl7p38g/exec";


// ==========================
// ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤
// ==========================
async function loadTenants() {
  try {
    const res = await fetch(`${API_URL}?action=getTenants`);
    const data = await res.json();

    const select = document.getElementById("tenantSelect");

    data.forEach(name => {
      const option = document.createElement("option");
      option.value = name;
      option.textContent = name;
      select.appendChild(option);
    });

  } catch (err) {
    console.error(err);
  }
}


// ==========================
// ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏∑‡∏≠‡∏ô
// ==========================
async function loadMonth() {

  const month = document.getElementById("monthSelect").value;
  if (!month) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏î‡∏∑‡∏≠‡∏ô");

  try {
    const res = await fetch(`${API_URL}?action=getByMonth&month=${encodeURIComponent(month)}`);
    const data = await res.json();
    renderTable(data);
  } catch (err) {
    console.error(err);
  }
}


// ==========================
// ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤
// ==========================
async function loadTenant() {

  const tenant = document.getElementById("tenantSelect").value;
  if (!tenant) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡πà‡∏≤");

  try {
    const res = await fetch(`${API_URL}?action=getByTenant&tenant=${encodeURIComponent(tenant)}`);
    const data = await res.json();
    renderTable(data);
  } catch (err) {
    console.error(err);
  }
}


// ==========================
// ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏ï‡∏≤‡∏£‡∏≤‡∏á
// ==========================
function renderTable(data) {

  const tbody = document.getElementById("tableBody");
  tbody.innerHTML = "";

  if (!data || data.length === 0) {
    tbody.innerHTML = "<tr><td colspan='5' class='empty'>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</td></tr>";
    return;
  }

  data.forEach(row => {

    const tr = document.createElement("tr");

    tr.innerHTML = `
      <td>${row.tenant || ""}</td>
      <td>${row.month}</td>
      <td>${row.elecNew}</td>
      <td>${row.waterNew}</td>
      <td>${row.water2New}</td>
    `;

    tbody.appendChild(tr);
  });
}


// ‡πÇ‡∏´‡∏•‡∏î dropdown ‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤
loadTenants();

</script>

</body>
</html>